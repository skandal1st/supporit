# Скрипт сканирования сети

Этот скрипт используется для сканирования сети и получения детальной информации об устройствах.

## Установка зависимостей

Скрипт использует виртуальное окружение Python для изоляции зависимостей.

### Первоначальная установка:

```bash
cd server/scripts
python3 -m venv venv
source venv/bin/activate  # Linux/macOS
# или для Windows:
# venv\Scripts\activate

pip install -r requirements.txt
```

Виртуальное окружение будет автоматически использоваться API endpoint'ом.

### Установка зависимостей вручную:

Если вы хотите установить зависимости вручную в активированном виртуальном окружении:

```bash
source venv/bin/activate  # Активируйте виртуальное окружение
pip install ping3 python-nmap ldap3 pywinrm
```

**Примечание**: 
- `pywinrm` требуется только для получения информации о Windows компьютерах через WinRM
- `ldap3` требуется только для работы с доменом Active Directory
- `python-nmap` требуется только для расширенного сканирования портов и определения ОС
- Все зависимости устанавливаются в виртуальное окружение, что не влияет на системный Python

## Использование

### Базовое сканирование подсети:

```bash
# С виртуальным окружением (рекомендуется)
source venv/bin/activate  # Linux/macOS
python network_scanner.py --subnet 192.168.1.0/24

# Или без активации (если виртуальное окружение создано)
venv/bin/python network_scanner.py --subnet 192.168.1.0/24
```

### Сканирование диапазона IP:

```bash
source venv/bin/activate
python network_scanner.py --start-ip 192.168.1.1 --end-ip 192.168.1.254
```

### Сканирование одного IP:

```bash
source venv/bin/activate
python network_scanner.py --single-ip 192.168.1.100
```

### Сканирование с учетными данными домена:

```bash
source venv/bin/activate
python network_scanner.py --subnet 192.168.1.0/24 \
  --domain-user "DOMAIN\\username" \
  --domain-password "password" \
  --domain-server "dc.example.com"
```

**Примечание**: API endpoint автоматически использует Python из виртуального окружения, если оно существует. Ручной запуск скрипта требует активации виртуального окружения или указания полного пути к Python.

## Возвращаемые данные

Скрипт возвращает JSON массив объектов с информацией об устройствах:

- `ip` - IP адрес устройства
- `is_alive` - доступность устройства (ping)
- `hostname` - имя хоста
- `mac` - MAC адрес
- `vendor` - производитель (определяется по MAC адресу)
- `response_time` - время отклика ping (мс)
- `os` - операционная система
- `os_version` - версия ОС
- `cpu` - процессор (только для компьютеров в домене)
- `ram` - объем оперативной памяти
- `hdd` - информация о жестком диске
- `domain` - домен (если устройство в домене)
- `manufacturer` - производитель компьютера
- `model` - модель компьютера
- `serial_number` - серийный номер (если доступен)
- `open_ports` - открытые порты (если используется nmap)
- `services` - информация о сервисах на открытых портах

## Требования

- Python 3.7+
- Доступ к сети для ping и ARP таблицы
- Для работы с доменом: учетные данные администратора домена
- Для работы с Windows компьютерами: WinRM должен быть включен на целевых машинах
- Для nmap сканирования: nmap должен быть установлен в системе

